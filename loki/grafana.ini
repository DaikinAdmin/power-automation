# Grafana Configuration for Power Automation
# This file provides enhanced security settings for production deployment

[server]
# The protocol (http, https, socket)
protocol = http
http_port = 3000
domain = powerautomation.pl
root_url = https://powerautomation.pl/grafana

# Serve Grafana from a sub path
serve_from_sub_path = true

# Alternative subdomain configuration (commented out)
;domain = logs.powerautomation.pl
;root_url = https://logs.powerautomation.pl
;serve_from_sub_path = false

[security]
# Set admin user and password from environment variables
admin_user = ${GRAFANA_ADMIN_USER}
admin_password = ${GRAFANA_ADMIN_PASSWORD}

# Disable user signups
disable_initial_admin_creation = false
allow_embedding = false

# Secret key for signing cookies
secret_key = ${GRAFANA_SECRET_KEY}

# Disable gravatar profile images
disable_gravatar = true

# Security headers
cookie_secure = true
cookie_samesite = strict
strict_transport_security = true
strict_transport_security_max_age_seconds = 31536000
strict_transport_security_preload = true
strict_transport_security_subdomains = true
x_content_type_options = true
x_xss_protection = true

[auth]
# Disable login form (use OAuth or other auth methods if needed)
disable_login_form = false

# OAuth auto login (if using OAuth in future)
;oauth_auto_login = false

[auth.anonymous]
# Disable anonymous access - require authentication for all pages
enabled = false

[auth.basic]
# Enable basic authentication
enabled = true

[users]
# Disable user signup and user creation
allow_sign_up = false
allow_org_create = false

# Users can only see their own profile
viewers_can_edit = false
editors_can_admin = false

[dashboards]
# Versioning enabled
versions_to_keep = 20

[log]
# Log mode: console, file, syslog
mode = console
level = info

[log.console]
format = json

[analytics]
# Disable analytics and reporting
reporting_enabled = false
check_for_updates = false
check_for_plugin_updates = false

[metrics]
# Enable basic metrics endpoint for monitoring
enabled = true
basic_auth_username = ${GRAFANA_ADMIN_USER}
basic_auth_password = ${GRAFANA_ADMIN_PASSWORD}

[alerting]
# Enable alerting
enabled = true
execute_alerts = true

[unified_alerting]
# Enable unified alerting
enabled = true

[explore]
# Enable Explore for debugging
enabled = true

[dataproxy]
# Timeout for data source proxy requests
timeout = 30
keep_alive_seconds = 30

[feature_toggles]
# Enable needed features
enable = 

[rendering]
# Server-side rendering
server_url =
callback_url =

[panels]
# Disable external plugins
disable_sanitize_html = false

[plugins]
# Plugin management
enable_alpha = false
allow_loading_unsigned_plugins = 

[enterprise]
# Enterprise features (if using Grafana Enterprise)
license_path = 
